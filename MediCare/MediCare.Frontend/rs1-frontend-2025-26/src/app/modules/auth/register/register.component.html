<div class="auth-container">
  <!-- Background -->
  <div class="auth-background">
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>
    <div class="bg-shape shape-3"></div>
  </div>

  <div class="auth-content">
    <!-- Brand -->
    <div class="auth-brand">
      <mat-icon class="brand-icon">person_add</mat-icon>
      <h1 class="brand-name">MediCare</h1>
      <p class="brand-tagline">Kreirajte svoj nalog</p>
    </div>

    <!-- Card -->
    <mat-card class="auth-card mat-elevation-z8">
      <mat-card-header>
        <mat-card-title>Registracija</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <!-- Error -->
        <div *ngIf="errorMessage" class="error-message">
          <mat-icon>error_outline</mat-icon>
          <span>{{ errorMessage }}</span>
        </div>

        <form [formGroup]="form" (ngSubmit)="onSubmit()">

          <!-- First & Last Name -->
          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" />
              <mat-error *ngIf="form.get('firstName')?.hasError('required')">
                Ime je obavezno
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" />
              <mat-error *ngIf="form.get('lastName')?.hasError('required')">
                Prezime je obavezno
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Username -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Username</mat-label>
            <input matInput formControlName="userName" />
            <mat-error *ngIf="form.get('userName')?.hasError('required')">
              Username je obavezan
            </mat-error>
          </mat-form-field>

          <!-- Email -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" />
            <mat-error *ngIf="form.get('email')?.hasError('required')">
              Email je obavezan
            </mat-error>
            <mat-error *ngIf="form.get('email')?.hasError('email')">
              Neispravan email
            </mat-error>
          </mat-form-field>

          <!-- Passwords -->
          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Password</mat-label>
              <input matInput [type]="hidePassword ? 'password' : 'text'"
                     formControlName="password" />
              <button mat-icon-button matSuffix type="button"
                      (click)="hidePassword = !hidePassword">
                <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              <mat-error *ngIf="form.get('password')?.hasError('required')">
                Lozinka je obavezna
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Confirm Password</mat-label>
              <input matInput [type]="hideConfirmPassword ? 'password' : 'text'"
                     formControlName="confirmPassword" />
              <button mat-icon-button matSuffix type="button"
                      (click)="hideConfirmPassword = !hideConfirmPassword">
                <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              <mat-error *ngIf="form.get('confirmPassword')?.hasError('required')">
                Potvrda lozinke je obavezna
              </mat-error>
              <mat-error *ngIf="form.get('confirmPassword')?.hasError('mismatch')">
                Lozinke se ne poklapaju
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Phone -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Phone Number</mat-label>
            <input matInput formControlName="phoneNumber" />
            <mat-error *ngIf="form.get('phoneNumber')?.hasError('required')">
              Telefon je obavezan
            </mat-error>
          </mat-form-field>

          <!-- Date of Birth -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Date of Birth</mat-label>
            <input matInput [matDatepicker]="picker"
                   formControlName="dateOfBirth">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>

          <!-- Address & City -->
          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Address</mat-label>
              <input matInput formControlName="address" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>City</mat-label>
              <input matInput formControlName="city" />
            </mat-form-field>
          </div>

          <!-- Submit -->
          <div class="actions">
            <button mat-raised-button color="primary"
                    type="submit"
                    [disabled]="form.invalid || isLoading">
              <ng-container *ngIf="!isLoading">
                <mat-icon>person_add</mat-icon>
                Registrujte se
              </ng-container>
              <mat-progress-spinner *ngIf="isLoading"
                mode="indeterminate" diameter="20"></mat-progress-spinner>
            </button>
          </div>

          <!-- Login -->
          <div class="register-prompt">
            <span>VeÄ‡ imate nalog? </span>
            <a routerLink="/auth/login">Prijavite se</a>
          </div>

        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
